(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[1763],{16472:(e,a,o)=>{"use strict";o.d(a,{default:()=>c});var t=o(95155),s=o(12115),n=o(48173),r=o.n(n),l=o(46878),i=o.n(l);function c(e){let{children:a}=e,[o,n]=(0,s.useState)(!1);return(0,t.jsxs)("div",{className:i().layout,children:[(0,t.jsxs)("nav",{className:i().nav,children:[(0,t.jsxs)("div",{className:i().navContent,children:[(0,t.jsx)(r(),{href:"/dashboard",className:i().logoLink,children:(0,t.jsx)("div",{className:i().logo,children:"Prosemble"})}),(0,t.jsxs)("div",{className:i().navLinks,children:[(0,t.jsx)(r(),{href:"/dashboard",className:i().navLink,children:"Dashboard"}),(0,t.jsx)(r(),{href:"/changelog",className:"".concat(i().navLink," ").concat(i().active),children:"Changelog"})]}),(0,t.jsx)("div",{className:i().mobileMenu,children:(0,t.jsx)("button",{className:i().menuButton,onClick:()=>n(!o),"aria-label":"Toggle menu",children:(0,t.jsxs)("div",{className:"".concat(i().menuIcon," ").concat(o?i().open:""),children:[(0,t.jsx)("span",{}),(0,t.jsx)("span",{}),(0,t.jsx)("span",{})]})})})]}),o&&(0,t.jsxs)("div",{className:i().mobileNav,children:[(0,t.jsx)(r(),{href:"/dashboard",className:i().mobileNavLink,onClick:()=>n(!1),children:"Dashboard"}),(0,t.jsx)(r(),{href:"/changelog",className:"".concat(i().mobileNavLink," ").concat(i().active),onClick:()=>n(!1),children:"Changelog"})]})]}),(0,t.jsx)("main",{className:i().main,children:a})]})}},46878:e=>{e.exports={layout:"ChangeLogLayout_layout__vOA0O",nav:"ChangeLogLayout_nav__EHQtv",navContent:"ChangeLogLayout_navContent__EI2Cq",logoLink:"ChangeLogLayout_logoLink___rUEt",logo:"ChangeLogLayout_logo__jgF8E",navLinks:"ChangeLogLayout_navLinks__TnPe8",navLink:"ChangeLogLayout_navLink__Vy3Xy",active:"ChangeLogLayout_active__eBKbP",mobileMenu:"ChangeLogLayout_mobileMenu__2vPte",menuButton:"ChangeLogLayout_menuButton__xKq9n",menuIcon:"ChangeLogLayout_menuIcon__9EQfm",open:"ChangeLogLayout_open__jUMKZ",mobileNav:"ChangeLogLayout_mobileNav___6C8y",mobileNavLink:"ChangeLogLayout_mobileNavLink__7A4JA",main:"ChangeLogLayout_main__d8QTW"}},55713:(e,a,o)=>{"use strict";o.d(a,{A:()=>d});var t=o(95155),s=o(12115),n=o(76046),r=o(5565),l=o(68996),i=o(79749),c=o(64542),m=o.n(c);function d(e){let{postId:a=null}=e,o=(0,n.useRouter)(),{isAuthenticated:c,user:d,identityId:u,uploadFile:p,getFileUrl:h,listFiles:g}=(0,l.m)(),_=(0,s.useRef)(null),[v,f]=(0,s.useState)(""),[x,j]=(0,s.useState)(""),[N,b]=(0,s.useState)("changelog"),[P,L]=(0,s.useState)(""),[y,C]=(0,s.useState)(""),[w,k]=(0,s.useState)([]),[F,I]=(0,s.useState)("open"),[S,U]=(0,s.useState)([]),[A,B]=(0,s.useState)([]),[E,G]=(0,s.useState)(!1),[T,M]=(0,s.useState)(!1),[H,R]=(0,s.useState)(null),[D,W]=(0,s.useState)(!1),[V,O]=(0,s.useState)(null);(0,s.useEffect)(()=>{if(!c){o.push("/login");return}a&&(W(!0),q(a))},[c,a,o]);let q=async e=>{G(!0),R(null);try{let a=(await g("changelog/")).filter(a=>a.key.includes("/".concat(e,".json")));if(0===a.length)throw Error("Post not found");let o=await h(a[0].key),t=await fetch(o);if(!t.ok)throw Error("Failed to fetch post data");let s=await t.json();if(O(s),f(s.title||""),j(s.content||""),b(s.type||"changelog"),L(s.version||""),k(s.tags||[]),C(s.tags?s.tags.join(", "):""),"problem"===s.type&&I(s.status||"open"),s.images&&s.images.length>0){let e=await Promise.all(s.images.map(e=>h(e)));B(e.map((e,a)=>({url:e,path:s.images[a]})))}}catch(e){console.error("Error loading post:",e),R("Failed to load post. Please try again.")}finally{G(!1)}},Q=e=>{let a=[...A],o=a.splice(e,1)[0];B(a),o.file&&(U(e=>e.filter(e=>e!==o.file)),URL.revokeObjectURL(o.url))},J=()=>{k([...new Set(y.split(",").map(e=>e.trim().toLowerCase()).filter(e=>e.length>0))])},K=async e=>{if(e.preventDefault(),!v.trim()){R("Title is required");return}if(!x.trim()){R("Content is required");return}J(),M(!0),R(null);try{let e=D?V.id:(0,i.A)(),a=new Date().toISOString(),t=[];if(D&&V.images)for(let e of A)e.path&&t.push(e.path);for(let a of S){let o=a.name.split(".").pop().toLowerCase(),s="changelog/".concat(e,"/images/").concat((0,i.A)(),".").concat(o);await p(a,s),t.push(s)}let s={id:e,title:v,content:x,type:N,tags:w,createdAt:D?V.createdAt:a,updatedAt:a,author:d.username,images:t};"changelog"===N&&P.trim()&&(s.version=P.trim()),"problem"===N&&(s.status=D?F:"open");let n="changelog/".concat(e,"/").concat(e,".json");await p(new Blob([JSON.stringify(s,null,2)],{type:"application/json"}),n),o.push("/changelog")}catch(e){console.error("Error saving post:",e),R("Failed to save post. Please try again."),M(!1)}};return E?(0,t.jsxs)("div",{className:m().loadingContainer,children:[(0,t.jsx)("div",{className:m().spinner}),(0,t.jsx)("p",{children:"Loading post data..."})]}):(0,t.jsxs)("div",{className:m().formContainer,children:[(0,t.jsx)("div",{className:m().formHeader,children:(0,t.jsx)("h1",{className:m().formTitle,children:D?"Edit Post":"Create New Post"})}),H&&(0,t.jsx)("div",{className:m().errorMessage,children:H}),(0,t.jsxs)("form",{onSubmit:K,className:m().form,children:[(0,t.jsxs)("div",{className:m().formGroup,children:[(0,t.jsx)("label",{className:m().formLabel,children:"Post Type"}),(0,t.jsxs)("div",{className:m().radioGroup,children:[(0,t.jsxs)("label",{className:m().radioLabel,children:[(0,t.jsx)("input",{type:"radio",name:"postType",value:"changelog",checked:"changelog"===N,onChange:()=>b("changelog"),className:m().radioInput}),"Changelog Entry"]}),(0,t.jsxs)("label",{className:m().radioLabel,children:[(0,t.jsx)("input",{type:"radio",name:"postType",value:"problem",checked:"problem"===N,onChange:()=>b("problem"),className:m().radioInput}),"Problem Report"]})]})]}),(0,t.jsxs)("div",{className:m().formGroup,children:[(0,t.jsx)("label",{htmlFor:"title",className:m().formLabel,children:"Title"}),(0,t.jsx)("input",{type:"text",id:"title",value:v,onChange:e=>f(e.target.value),className:m().formInput,placeholder:"Enter post title",required:!0})]}),"changelog"===N&&(0,t.jsxs)("div",{className:m().formGroup,children:[(0,t.jsx)("label",{htmlFor:"version",className:m().formLabel,children:"Version (optional)"}),(0,t.jsx)("input",{type:"text",id:"version",value:P,onChange:e=>L(e.target.value),className:m().formInput,placeholder:"e.g., 1.2.0"})]}),"problem"===N&&D&&(0,t.jsxs)("div",{className:m().formGroup,children:[(0,t.jsx)("label",{className:m().formLabel,children:"Status"}),(0,t.jsxs)("div",{className:m().radioGroup,children:[(0,t.jsxs)("label",{className:m().radioLabel,children:[(0,t.jsx)("input",{type:"radio",name:"status",value:"open",checked:"open"===F,onChange:()=>I("open"),className:m().radioInput}),"Open"]}),(0,t.jsxs)("label",{className:m().radioLabel,children:[(0,t.jsx)("input",{type:"radio",name:"status",value:"fixed",checked:"fixed"===F,onChange:()=>I("fixed"),className:m().radioInput}),"Fixed"]})]})]}),(0,t.jsxs)("div",{className:m().formGroup,children:[(0,t.jsx)("label",{htmlFor:"content",className:m().formLabel,children:"Content (Markdown supported)"}),(0,t.jsx)("textarea",{id:"content",value:x,onChange:e=>j(e.target.value),className:m().textArea,rows:10,placeholder:"Enter post content with Markdown formatting",required:!0}),(0,t.jsxs)("div",{className:m().markdownHint,children:[(0,t.jsx)("strong",{children:"Markdown tips:"})," Use # for headings, * for lists, ** for bold, * for italic, ``` for code blocks"]})]}),(0,t.jsxs)("div",{className:m().formGroup,children:[(0,t.jsx)("label",{htmlFor:"tags",className:m().formLabel,children:"Tags (comma separated)"}),(0,t.jsx)("input",{type:"text",id:"tags",value:y,onChange:e=>{C(e.target.value),J()},onBlur:J,className:m().formInput,placeholder:"e.g., ui, performance, bug"}),w.length>0&&(0,t.jsx)("div",{className:m().tagsPreview,children:w.map((e,a)=>(0,t.jsx)("span",{className:m().tagPreview,children:e},a))})]}),(0,t.jsxs)("div",{className:m().formGroup,children:[(0,t.jsx)("label",{className:m().formLabel,children:"Images (optional)"}),(0,t.jsxs)("div",{className:m().imageUploadArea,onClick:()=>_.current.click(),children:[(0,t.jsx)("div",{className:m().uploadIcon,children:(0,t.jsxs)("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[(0,t.jsx)("path",{d:"M21 12v7a2 2 0 01-2 2H5a2 2 0 01-2-2V5a2 2 0 012-2h7"}),(0,t.jsx)("path",{d:"M16 5h6v6"}),(0,t.jsx)("path",{d:"M8 21l15-15"})]})}),(0,t.jsxs)("div",{className:m().uploadText,children:[(0,t.jsx)("p",{children:"Click to upload images"}),(0,t.jsx)("p",{className:m().uploadHint,children:"PNG, JPG, GIF up to 5MB"})]}),(0,t.jsx)("input",{type:"file",ref:_,onChange:e=>{let a=Array.from(e.target.files);U(e=>[...e,...a]);let o=a.map(e=>({url:URL.createObjectURL(e),file:e}));B(e=>[...e,...o])},multiple:!0,accept:"image/*",className:m().fileInput})]}),A.length>0&&(0,t.jsx)("div",{className:m().imagePreviewContainer,children:A.map((e,a)=>(0,t.jsx)("div",{className:m().imagePreviewItem,children:(0,t.jsxs)("div",{className:m().imagePreviewWrapper,children:[(0,t.jsx)(r.default,{src:e.url,alt:"Preview ".concat(a+1),width:100,height:100,className:m().imagePreview}),(0,t.jsx)("button",{type:"button",onClick:()=>Q(a),className:m().removeImageButton,"aria-label":"Remove image",children:"\xd7"})]})},a))})]}),(0,t.jsxs)("div",{className:m().formActions,children:[(0,t.jsx)("button",{type:"button",onClick:()=>o.push("/changelog"),className:m().cancelButton,children:"Cancel"}),(0,t.jsx)("button",{type:"submit",className:m().submitButton,disabled:T,children:T?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("span",{className:m().buttonSpinner}),D?"Saving...":"Publishing..."]}):D?"Save Changes":"Publish Post"})]})]})]})}},64542:e=>{e.exports={formContainer:"PostForm_formContainer__oTUXg",formHeader:"PostForm_formHeader__e7LLM",formTitle:"PostForm_formTitle__Q5ZD4",errorMessage:"PostForm_errorMessage__8GPnr",form:"PostForm_form__w1rCh",formGroup:"PostForm_formGroup__Yo8gm",formLabel:"PostForm_formLabel__pZ4vo",formInput:"PostForm_formInput__7P0Nd",textArea:"PostForm_textArea__LCE_e",markdownHint:"PostForm_markdownHint__WEdNQ",radioGroup:"PostForm_radioGroup__traAf",radioLabel:"PostForm_radioLabel__h_4CC",radioInput:"PostForm_radioInput__arNBs",imageUploadArea:"PostForm_imageUploadArea__W58C5",uploadIcon:"PostForm_uploadIcon__YJDit",uploadText:"PostForm_uploadText__WnTzh",uploadHint:"PostForm_uploadHint__BH3pH",fileInput:"PostForm_fileInput__U4zOe",imagePreviewContainer:"PostForm_imagePreviewContainer__2PiIr",imagePreviewItem:"PostForm_imagePreviewItem__mj47r",imagePreviewWrapper:"PostForm_imagePreviewWrapper__nfJ7k",imagePreview:"PostForm_imagePreview__kW21V",removeImageButton:"PostForm_removeImageButton__3vmuQ",tagsPreview:"PostForm_tagsPreview__MHUne",tagPreview:"PostForm_tagPreview__1kYjL",formActions:"PostForm_formActions___p_uw",cancelButton:"PostForm_cancelButton__n2N9m",submitButton:"PostForm_submitButton__S4Vfz",buttonSpinner:"PostForm_buttonSpinner__x74PP",spin:"PostForm_spin__WSsZy",loadingContainer:"PostForm_loadingContainer__5Vd2K",spinner:"PostForm_spinner__iu8RN"}},79749:(e,a,o)=>{"use strict";let t;o.d(a,{A:()=>l});let s={randomUUID:"undefined"!=typeof crypto&&crypto.randomUUID&&crypto.randomUUID.bind(crypto)},n=new Uint8Array(16),r=[];for(let e=0;e<256;++e)r.push((e+256).toString(16).slice(1));let l=function(e,a,o){if(s.randomUUID&&!a&&!e)return s.randomUUID();let l=(e=e||{}).random||(e.rng||function(){if(!t&&!(t="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)))throw Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return t(n)})();if(l[6]=15&l[6]|64,l[8]=63&l[8]|128,a){o=o||0;for(let e=0;e<16;++e)a[o+e]=l[e];return a}return function(e,a=0){return r[e[a+0]]+r[e[a+1]]+r[e[a+2]]+r[e[a+3]]+"-"+r[e[a+4]]+r[e[a+5]]+"-"+r[e[a+6]]+r[e[a+7]]+"-"+r[e[a+8]]+r[e[a+9]]+"-"+r[e[a+10]]+r[e[a+11]]+r[e[a+12]]+r[e[a+13]]+r[e[a+14]]+r[e[a+15]]}(l)}}}]);